---
title: "Chapter 3"
author: "Dimitrios Tsallos"
date: "11/21/2017"
output: html_document
---

# 3^nd^ Week

## Logistic Regression

```{r, include=FALSE}
knitr::opts_chunk$set(include = FALSE)
# set working directory
setwd( "/Users/dtsallos/Desktop/OneDrive - University of Helsinki/GitHub/IODS-project/data")
# read the alc data into memory
alc <- read.csv("student-combined.csv", sep = ",",header=TRUE)
alc <- alc[,-1] #remove column X with row numbers
```

### Student performance dataset

This week, we are working with a new dataset. This data approach student achievement in secondary education of two Portuguese schools. The data attributes include student grades, demographic, social and school related features) and it was collected by using school reports and questionnaires. Two datasets are provided regarding the performance in two distinct subjects: Mathematics (mat) and Portuguese language (por). In [Cortez and Silva, 2008], the two datasets were modeled under binary/five-level classification and regression tasks. 

high and low alcohol consumption should be mentiond...

*You can find out more about this dataset and the related study [here](https://archive.ics.uci.edu/ml/datasets/Student+Performance).* 

But here is the variable names included in the following analysis: 
  
  
```{r, echo=FALSE}
colnames(alc)
```

And here is how the data has been structured:

```{r, echo=FALSE}
str(alc)

```


### Hypothesis

Using the given data, we are going to study student's behavior with regards to alcohol consumption. According to stereotypes, students who are being raised by one of the two parents alone (Pstatus = A, "apart") are more likely to seek alcohol to soothen emotional distress. When those students are members of big families (famsize = GT3, "greater than 3") the situation could lead to higher alcohol consumption. These students are also more likely to miss class (absences are numeric from 0 to 93). While those students who are busy with extracurricular activities (activities = yes) could be distracted, get more supervision and support which leads to less alcohol consumption and less abcences recorded from class. Let's study now if that is true based on the given data sample.  

famsize - family size (binary: 'LE3' - less or equal to 3 or 'GT3' - greater than 3) 
Pstatus - parent's cohabitation status (binary: 'T' - living together or 'A' - apart) 
activities - extra-curricular activities (binary: yes or no) 
absences - number of school absences (numeric: from 0 to 93) 


## 

Numerically and graphically explore the distributions of your chosen variables and their relationships with alcohol consumption (use for example cross-tabulations, bar plots and box plots). Comment on your findings and compare the results of your exploration to your previously stated hypotheses. (0-5 points)




```{r}
library(dplyr)
#make a shorter table to use for your own hypothesis testing exercise
alc2 <- select(alc, famsize, Pstatus, activities, absences, alc_use, high_use) 
library(gmodels)
CrossTable(alc$high_use, alc$famsize)
CrossTable(alc$high_use, alc$Pstatus)
CrossTable(alc$high_use, alc$activities)
#CrossTable(alc$high_use, alc$absences) can't do that one Make a plot instead

p2 <- ggplot(alc2, aes(x = absences, fill = high_use))
p2 + geom_bar() + facet_wrap("high_use") + ggtitle("#") + theme_bw()
#maybe density plot is better
p1 <- ggplot(alc, aes(x= absences, fill=high_use)) + geom_density(alpha=.3)
p1 + ggtitle("Absence distribution") + theme_bw()
#calculate mean and median to see the scewens of the data?
```


 4. Absences: From the table, we can see that students those were away from school had higher consumption of alcohal. Similarly, box plot shows that higher the absence leads to more consumption of alcohal.

Male high users are more likely to be absent from class. Females are more likely to be absent in all groups..
```{r}
library(GGally); library(ggplot2) # load libraries
#tbl <- alc %>% select(sex, absences, freetime, activities, alc_use, high_use) # select interesting variables

p3 <- ggplot(alc, aes(high_use, absences, fill = sex)) + geom_boxplot() + theme_bw() #add dots all over the plot
p3 #+ ggtitle etc

```









```{r, eval=FALSE, include=FALSE}

gather(alc2) %>%
  ggplot(aes(value)) + 
  geom_bar() +
  facet_wrap("key", scales = "free") 

## somehting Vs alc_use or HIgh_use





p1 <- ggplot(alc, aes(x= G3, fill=high_use)) + geom_density(alpha=.3)
p1 + ggtitle("Final grade distribution") + theme_bw()


p1 <- ggplot(alc, aes(x= absences, fill=sex)) + geom_density(alpha=.3)
p1 + ggtitle("Absence distribution") + theme_bw()


p2 <- ggplot(alc, aes(x = high_use, fill = sex))
p2 + geom_bar() + facet_wrap("sex") + ggtitle("Student sex and alcohol consumption") + theme_bw()

```











